{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peripheral Vision Training</title>
    <link rel="stylesheet" href="{% static 'css/start.css' %}">
</head>
<body>
    {% csrf_token %}
    <!-- Page 1: Device Settings -->
    <div id="page1" class="page">
        <div class="header">Peripheral Vision Training</div>
        <div class="settings-group">
            <label for="deviceType">Device Type:</label>
            <select id="deviceType">
                <option value="desktop">Desktop</option>
                <option value="laptop">Laptop</option>
            </select>
            <label for="screenSize">Screen Size (inches):</label>
            <input type="number" id="screenSize" value="19" oninput="updateViewingDistance()">
            <p>Viewing Distance: <span id="viewingDistance"></span></p>
            <label for="resolutionWidth">Resolution Width:</label>
            <input type="number" id="resolutionWidth" value="1920">
            <label for="resolutionHeight">Resolution Height:</label>
            <input type="number" id="resolutionHeight" value="1080">
        </div>
        <div class="button-group">
            <button class="btn choice" onclick="enterFullscreenAndContinue()">Next</button>
        </div>
    </div>

    <!-- Page 2: Mode Selection -->
    <div id="page2" class="page" style="display: none;">
        <div class="header">Select Mode</div>
        <div class="button-group">
            <button class="btn choice" onclick="currentMode = 'training'; updateSpeedLabel(); enterFullscreenAndContinue();">Training</button>
            <button class="btn choice" onclick="currentMode = 'testing'; updateSpeedLabel(); enterFullscreenAndContinue();">Testing</button>
        </div>
    </div>

    <!-- Page 3: Speed and Timing Settings -->
    <div id="page3" class="page" style="display: none;">
        <div class="header">Settings</div>
        <div class="settings-group">
            <label id="speedLabel" for="speed">Speed:</label>
            <input type="number" id="speed" value="500" oninput="speed = parseInt(this.value) || (currentMode === 'training' ? 500 : 1)">
            <label for="timeLimit">Time Limit (s):</label>
            <input type="number" id="timeLimit" value="120" oninput="timeLimit = parseInt(this.value) || 120">
            <label for="selectionTimeout">Selection Timeout (ms):</label>
            <input type="number" id="selectionTimeout" value="1200" oninput="selectionTimeout = parseInt(this.value) || 1200">
            <label for="centralToSelectionGap">Central to Selection Gap (ms):</label>
            <input type="number" id="centralToSelectionGap" value="500" oninput="centralToSelectionGap = parseInt(this.value) || 500">
            <label for="selectionToCentralGap">Selection to Central Gap (ms):</label>
            <input type="number" id="selectionToCentralGap" value="1000" oninput="selectionToCentralGap = parseInt(this.value) || 1000">
        </div>
        <div class="button-group">
            <button class="btn choice" onclick="showPage(2)">Back</button>
            <button class="btn choice" onclick="enterFullscreenAndContinue()">Next</button>
        </div>
    </div>

    <!-- Page 4: Instructions -->
    <div id="page4" class="page" style="display: none;">
        <div class="header">Instructions</div>
        <div class="settings-group text-center">
            <p>Use the following keys to select the corner lights:</p>
            <p><strong>Q:</strong> Top-Left, <strong>W:</strong> Top-Right, <strong>A:</strong> Bottom-Left, <strong>S:</strong> Bottom-Right</p>
            <p>Alternatively, click on the corner lights with your mouse.</p>
            <p>Use arrow keys to navigate between buttons and Enter to select, or click the buttons directly.</p>
            <p>Press Esc to pause the session.</p>
        </div>
        <div class="button-group">
            <button class="btn choice" onclick="showPage(3)">Back</button>
            <button class="btn choice" onclick="startSession()">Start</button>
        </div>
    </div>

<!-- Page 5: Distance Detection -->
<div id="page5" class="container" style="display: none;">
    <button class="back-btn" onclick="showPreviousPage()">Back</button>
    <div class="header">Peripheral Vision Training</div>
    <div class="settings-group">
        <label>Device Type:</label>
        <select id="deviceType">
            <option value="desktop">Desktop</option>
            <option value="laptop">Laptop</option>
        </select>
        <p class="default-note">Select your device type to calculate the optimal viewing distance.</p>
        
        <label>Screen Size (Diagonal in Inches):</label>
        <input type="number" id="screenSize" step="1" value="19">
        <p class="default-note">Enter your screen's diagonal size (e.g., 27 for a 27-inch monitor, 15 for a 15-inch laptop).</p>

        <label for="resolutionWidth">Screen Resolution Width (px):</label>
        <input type="number" id="resolutionWidth" placeholder="e.g., 1920" step="1">
        <label for="resolutionHeight">Screen Resolution Height (px):</label>
        <input type="number" id="resolutionHeight" placeholder="e.g., 1080" step="1">
        <p class="default-note">Enter your screen's resolution (e.g., 1920x1080)</p>

        <p class="text-center mt-3">
            <strong>Recommended Viewing Distance:</strong> 
            <span id="viewingDistance">Please enter your screen details to calculate.</span>
        </p>
        <p class="text-center">
            <strong>Horizontal Field of View:</strong> 
            <span id="hFov">--</span>Â°
        </p>
    </div>
    <div class="button-group">
        <button class="btn choice" onclick="window.open('/onspot-distance-detection/', '_blank')">On-Spot Distance Detection</button>
        <button class="btn choice" onclick="startSession()">Start</button>
    </div>
</div>

    <!-- Mobile Warning -->
    <div id="mobileWarning" class="container" style="display: none;">
        <div class="header">Peripheral Vision Training</div>
        <p class="text-center">This app is designed for use on laptops and desktops only. For the best experience, please access the app on a laptop or desktop device.</p>
    </div>

    <script src="{% static 'js/start.js' %}"></script>
</body>
</html>